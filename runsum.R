# Generate running sum for population count# # Filename: runsum.R# Author: Darren Kavanagh# Created: 20.06.2009# Last Modified:# ======================================================# Based on  Splus code from Holmes 2004 # (see ESA Ecological Archives A014-023-S1.) ## Code assumes that there are no missing census years## ncount: a time series with an entry for each year# L: number of N's to add together to make runsumrunsum <- function (ncount, L=5) {        runsumfilt <- rep(1,L) # filter to use to produce the running sum	# check to see if no of counts is sufficent	if(length(ncount)<=length(runsumfilt)) { 		print("Error: Nt too short for runsum filter")		return(list("NA"))	}		rscount <- filter(ncount,runsumfilt,method="con",sides=1)    rscount <- na.omit(rscount)   # remove trailing NAs    rscount <- as.vector(rscount) # get rid of timeseries data format        # zeros in the running sum are not allowed    	if(is.element(0,rscount)) { 		print("Error: too many consecutive 0s in Nt")		return(list("NA"))	}		return(rscount)   }