# Calculates distributions of µ and σ2 for # the monte carlo simulation confidence intervals## Filename: riskmcp.R# Author: Darren Kavanagh# Created: 06.08.2009# Last Modified:# ======================================================# # Based on Splus code from Holmes 2004 # (see ESA Ecological Archives A014-023-S1.) ## nts: number of counts# mu: µ determines how quickly the mean increases# sigmasq: σ2 determines how quickly the variance increases# L: number of N's to add together to make runsum## load libraries and functionssource('dfslp.R')riskmcp <- function (nts=NA, mu=NA, sigmasq=NA, L=NA) {	degfr <- dfslp(nts, L) # slope degrees of freedom	# calculate distributions of µ and σ2	tmpreps <- 1000	murnds <- rt(tmpreps,degfr)*sqrt(sigmasq/(nts-L))+mu	mulow <- qt(.025,degfr)*sqrt(sigmasq/(nts-L))+mu	muhigh <- qt(.975,degfr)*sqrt(sigmasq/(nts-L))+mu	s2slprnds <- sigmasq*degfr/rchisq(tmpreps,degfr)	s2low <- sigmasq*degfr/qchisq(.975,degfr)	s2high <- sigmasq*degfr/qchisq(.025,degfr)	okparams <- (murnds<=muhigh) & (murnds>=mulow) & (s2slprnds<=s2high) & (s2slprnds>=s2low)	murnds <- murnds[okparams]	s2slprnds <- s2slprnds[okparams]		return(data.frame(murnds, s2slprnds))}